ALTER PROCEDURE dbo.NuevoId

@NameTable varchar(20),
@RetValor int OUTPUT

/*
	(
		@parameter1 datatype = default value,
		@parameter2 datatype OUTPUT
	)
*/
AS
	/* SET NOCOUNT ON */
	
	set @retvalor=0
	
	SELECT Name FROM SysObjects WHERE Name='KEYSID' AND Type='U'
	
    IF @@ROWCOUNT < 1
       CREATE TABLE Keysid ( TableName Char(20), LastKeyVal Integer )
  	 
    SELECT LastKeyVal FROM Keysid WHERE TableName=@NameTable
    
	IF @@ROWCOUNT < 1	   
	   INSERT INTO Keysid VALUES (@NameTable, 0 )		   
	   
       		
  	UPDATE Keysid  	       
  	       SET @RetValor = LastkeyVal = LasTkeyVal + 1 WHERE TableName=@NameTable
  	 	   	
	RETURN 
