15-05-2023 19:04:58 , PLANCOMIVENDE_V3.IMPRIMIR_VISTAPREVIA1.IMPRESORA.CLICK, Error: SQL: la cláusula ORDER BY no es válida.;Linea : SELECT idvendedor,0 as grupo,idcanalvta as id,codcanalvta as codigo ,nomcanalvta as nombre ,codvendedor,nomvendedor,cantcomproba ,SUM(unidades) as unidades,SUM(netogravado)as importe,SUM(vtakilos) as kilos ,comicanal as porcomi,CAST(0 as n(6,2)) as comi, 1 as clave ,0 as id_r,0 as codigo_r,SPACE(15) as nombre_r ,CAST(0 as n(11,2)) as unidades_r, CAST(0 as n(11,2)) as importe_r,CAST(0 as n(11,2)) as kilos_r ,CAST(0 as n(6,2)) as porcomi_r,CAST(0 as n(6,2)) as comi_r FROM CsrSeguimiento WHERE filtro=0  AND filtrorubro = 0 AND comicanal<> 0 GROUP BY idvendedor,codvendedor,nomvendedor,comicanal ,idcanalvta,codcanalvta,nomcanalvta,comicanal,cantcomproba UNION ALL SELECT idvendedor,0 as grupo,idcanalvta as id,codcanalvta as codigo ,nomcanalvta as nombre ,codvendedor,nomvendedor,cantcomproba ,CAST(0 as n(11,2)) as unidades, CAST(0 as n(11,2))as importe,CAST(0 as n(11,2)) as kilos ,CAST(0 as n(6,2)) as porcomi,CAST(0 as n(6,2)) as comi, 1 as clave ,idrubro as id_r,codrubro as codigo_r ,nomrubro as nombre_r ,SUM(unidades) as unidades_r,SUM(netogravado)as importe_r,SUM(vtakilos) as kilos_r ,comicanal as porcomi_r,CAST(0 as n(6,2)) as comi_r FROM CsrSeguimiento WHERE filtro=0 AND filtrorubro = 0 AND comicanal<> 0 GROUP BY idvendedor,codvendedor,nomvendedor,comicanal ,idcanalvta,codcanalvta,nomcanalvta,comicanal,idrubro,codrubro,nomrubro,cantcomproba UNION ALL SELECT idvendedor,0 as grupo,idrubro as id,codrubro as codigo ,nomrubro as nombre ,codvendedor,nomvendedor,cantcomproba ,SUM(unidades) as unidades,SUM(netogravado)as importe,SUM(vtakilos) as kilos ,CAST(0 as n(6,2)) as porcomi,CAST(0 as n(6,2)) as comi , 0 as clave ,0 as id_r,0 as codigo_r,SPACE(15) as nombre_r ,CAST(0 as n(11,2)) as unidades_r, CAST(0 as n(11,2)) as importe_r,CAST(0 as n(11,2)) as kilos_r ,CAST(0 as n(6,2)) as porcomi_r,CAST(0 as n(6,2)) as comi_r FROM CsrSeguimiento WHERE filtro=0 AND filtrorubro = 0 AND comicanal = 0 GROUP BY idvendedor,idrubro,codrubro ,nomrubro,codvendedor,nomvendedor,cantcomproba UNION ALL SELECT idvendedor,1 as grupo,idarticulo as id,codigo as codigo ,articulo as nombre ,codvendedor,nomvendedor,cantcomproba ,SUM(unidades) as unidades,SUM(netogravado)as importe,SUM(vtakilos) as kilos ,CAST(0 as n(6,2)) as porcomi,CAST(0 as n(6,2)) as comi , 0 as clave ,0 as id_r,0 as codigo_r,SPACE(15) as nombre_r ,CAST(0 as n(11,2)) as unidades_r, CAST(0 as n(11,2)) as importe_r,CAST(0 as n(11,2)) as kilos_r ,CAST(0 as n(6,2)) as porcomi_r,CAST(0 as n(6,2)) as comi_r FROM CsrSeguimiento WHERE filtro=1  GROUP BY idvendedor,idarticulo,codigo,articulo ,codvendedor,nomvendedor,cantcomproba UNION ALL SELECT idvendedor,1 as grupo,idrubro as id,codrubro as codigo ,nomrubro as nombre ,codvendedor,nomvendedor,cantcomproba ,SUM(unidades) as unidades,SUM(netogravado)as importe,SUM(vtakilos) as kilos ,CAST(0 as n(6,2)) as porcomi,CAST(0 as n(6,2)) as comi , 0 as clave ,0 as id_r,0 as codigo_r,SPACE(15) as nombre_r ,CAST(0 as n(11,2)) as unidades_r, CAST(0 as n(11,2)) as importe_r,CAST(0 as n(11,2)) as kilos_r ,CAST(0 as n(6,2)) as porcomi_r,CAST(0 as n(6,2)) as comi_r FROM CsrSeguimiento WHERE  filtrorubro = 1 GROUP BY idvendedor,idrubro,codrubro ,nomrubro,codvendedor,nomvendedor,cantcomproba ORDER BY idvendedor,grupo,codigo INTO CURSOR CsrImprimir READWRITE;Error :       1808;Ultimo Alias Activo: CSRSEGUIMIENTO;Ultimo registro:         63 ;DBF: C:\USERS\MARCO\APPDATA\LOCAL\TEMP\0000EO7D02ZY.TMP;Ultimo Control activo: 
15-05-2023 19:04:58 , Pila de llamadas
15-05-2023 19:04:58 , Programa    : j:\xsoftsql\desarrollo\clases\controles.vct
15-05-2023 19:04:58 , Objeto      : plancomivende_v3.imprimir_vistaprevia1.impresora.click
15-05-2023 19:04:58 , Base Objeto : j:\xsoftsql\desarrollo\clases\controles.vct
15-05-2023 19:04:58 , Nº de Linea :          8
15-05-2023 19:04:58 , En el Fuente: 	llOK=thisform.CrearInforme()
15-05-2023 19:04:58 , Programa    : j:\xsoftsql\proyectos\distribuidora\forms\comision\plancomivende_v3.sct
15-05-2023 19:04:58 , Objeto      : plancomivende_v3.crearinforme
15-05-2023 19:04:58 , Base Objeto : j:\xsoftsql\proyectos\distribuidora\forms\comision\plancomivende_v3.sct
15-05-2023 19:04:58 , Nº de Linea :        185
15-05-2023 19:04:58 , En el Fuente: SELECT idvendedor,0 as grupo,idcanalvta as id,codcanalvta as codigo,nomcanalvta as nombre ,codvendedor,nomvendedor,cantcomproba,SUM(unidades) as unidades,SUM(netogravado)as importe,SUM(vtakilos) as kilos ,comicanal as porcomi,CAST(0 as n(6,2)) as comi, 1 as clave ,0 as id_r,0 as codigo_r,SPACE(15) as nombre_r,CAST(0 as n(11,2)) as unidades_r, CAST(0 as n(11,2)) as importe_r,CAST(0 as n(11,2)) as kilos_r ,CAST(0 as n(6,2)) as porcomi_r,CAST(0 as n(6,2)) as comi_rFROM CsrSeguimiento WHERE filtro=0  AND filtrorubro = 0 AND comicanal<> 0 GROUP BY idvendedor,codvendedor,nomvendedor,comicanal ,idcanalvta,codcanalvta,nomcanalvta,comicanal,cantcomprobaUNION ALL SELECT idvendedor,0 as grupo,idcanalvta as id,codcanalvta as codigo,nomcanalvta as nombre ,codvendedor,nomvendedor,cantcomproba,CAST(0 as n(11,2)) as unidades, CAST(0 as n(11,2))as importe,CAST(0 as n(11,2)) as kilos ,CAST(0 as n(6,2)) as porcomi,CAST(0 as n(6,2)) as comi, 1 as clave ,idrubro as id_r,codrubro as codigo_r,nomrubro as nombre_r,SUM(unidades) as unidades_r,SUM(netogravado)as importe_r,SUM(vtakilos) as kilos_r ,comicanal as porcomi_r,CAST(0 as n(6,2)) as comi_rFROM CsrSeguimiento WHERE filtro=0 AND filtrorubro = 0 AND comicanal<> 0 GROUP BY idvendedor,codvendedor,nomvendedor,comicanal ,idcanalvta,codcanalvta,nomcanalvta,comicanal,idrubro,codrubro,nomrubro,cantcomprobaUNION ALL SELECT idvendedor,0 as grupo,idrubro as id,codrubro as codigo,nomrubro as nombre ,codvendedor,nomvendedor,cantcomproba,SUM(unidades) as unidades,SUM(netogravado)as importe,SUM(vtakilos) as kilos ,CAST(0 as n(6,2)) as porcomi,CAST(0 as n(6,2)) as comi , 0 as clave,0 as id_r,0 as codigo_r,SPACE(15) as nombre_r,CAST(0 as n(11,2)) as unidades_r, CAST(0 as n(11,2)) as importe_r,CAST(0 as n(11,2)) as kilos_r ,CAST(0 as n(6,2)) as porcomi_r,CAST(0 as n(6,2)) as comi_rFROM CsrSeguimiento WHERE filtro=0 AND filtrorubro = 0 AND comicanal = 0 GROUP BY idvendedor,idrubro,codrubro,nomrubro,codvendedor,nomvendedor,cantcomproba UNION ALL SELECT idvendedor,1 as grupo,idarticulo as id,codigo as codigo,articulo as nombre ,codvendedor,nomvendedor,cantcomproba,SUM(unidades) as unidades,SUM(netogravado)as importe,SUM(vtakilos) as kilos ,CAST(0 as n(6,2)) as porcomi,CAST(0 as n(6,2)) as comi , 0 as clave,0 as id_r,0 as codigo_r,SPACE(15) as nombre_r,CAST(0 as n(11,2)) as unidades_r, CAST(0 as n(11,2)) as importe_r,CAST(0 as n(11,2)) as kilos_r ,CAST(0 as n(6,2)) as porcomi_r,CAST(0 as n(6,2)) as comi_rFROM CsrSeguimiento WHERE filtro=1  GROUP BY idvendedor,idarticulo,codigo,articulo,codvendedor,nomvendedor,cantcomproba UNION ALL SELECT idvendedor,1 as grupo,idrubro as id,codrubro as codigo,nomrubro as nombre ,codvendedor,nomvendedor,cantcomproba,SUM(unidades) as unidades,SUM(netogravado)as importe,SUM(vtakilos) as kilos ,CAST(0 as n(6,2)) as porcomi,CAST(0 as n(6,2)) as comi , 0 as clave,0 as id_r,0 as codigo_r,SPACE(15) as nombre_r,CAST(0 as n(11,2)) as unidades_r, CAST(0 as n(11,2)) as importe_r,CAST(0 as n(11,2)) as kilos_r ,CAST(0 as n(6,2)) as porcomi_r,CAST(0 as n(6,2)) as comi_rFROM CsrSeguimiento WHERE  filtrorubro = 1 GROUP BY idvendedor,idrubro,codrubro,nomrubro,codvendedor,nomvendedor,cantcomproba ORDER BY idvendedor,grupo,codigo INTO CURSOR CsrImprimir READWRITE 
15-05-2023 19:04:58 , Fin
