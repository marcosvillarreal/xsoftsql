SELECT 'A' as grupo,CsrMaopera.id as orden,CsrMaopera.idcomproba
,CsrCabeza.talonario,convert(char(8), CsrCabeza.fecha,112) as chrfecha, CsrCabeza.fecha as fechafac
,CsrCabeza.cuit as cuit,ISNULL(CsrCabeza.dni,ISNULL(CsrCtacte.dni,0)) as nrodni
,CsrCategoiva.abrevia as categoiva, CsrCode.CodAfip  as TipoCbte
,0 as informado, SPACE(13) as proximonro,SPACE(14) as cae,SPACE(4) as caetipo,SPACE(8) as chrvtocae
,isnull((select top 1 vencimien from MovCtacte as CsrMovCtacte where CsrMaopera.id = CsrMovCtacte.idmaopera),CsrCabeza.fecha) as fechavto
,ISNULL(CsrCabeza.cnombre,SPACE(15)) as nomctacte
,ISNULL(CsrCtacte.cdatosfac,'') as datosfactura
,CsrCabeza.total,SPACE(30) as nomvendedor,CsrComproba.cnombre as nomcompro
,CsrCabeza.switch
from CabeFac as CsrCabeza
left join maopera as Csrmaopera on CsrCabeza.idmaopera = Csrmaopera.id
left join categoiva as Csrcategoiva on CsrCabeza.idtipoiva = Csrcategoiva.id
left join comprobante as Csrcomprobante on Csrmaopera.idcomproba = Csrcomprobante.id
left join ctacte as Csrctacte on CsrCabeza.idctacte = CsrCtacte.id
left join afipcomproba as CsrCode on CsrCabeza.idtipocbte = CsrCode.id 
left join comprobante as CsrComproba on CsrMaopera.idcomproba = CsrComproba.id
where Csrmaopera.origen IN ('FAC','FPE') and Csrmaopera.clasecomp IN ('A','B','C','U') 
AND LEFT(CsrMaopera.numcomp,1)='' and CsrCabeza.infocae = 0
and CsrCabeza.idtipocbte > 0
and CsrMaopera.estado = 0
Order by CsrMaopera.id