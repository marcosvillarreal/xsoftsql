SELECT 'B' as grupo, CsrMaopera.id as orden,0 as estado
,'IG' as tipoconce,CsrTipoiva.SiapCpraVta as CodTasa
,CAST(0 as numeric(12,2)) as Tasa
,SUM(ISNULL(Csrtablaimp.importe,CAST(0 as numeric(12,2)))) as Importe
,SUM(ISNULL(Csrtablaimp.baseimp,CAST(0 as numeric(12,2)))) as BaseImp
from Cabefac as CsrCabeza
left join maopera as Csrmaopera on CsrCabeza.idmaopera = Csrmaopera.id
left join tablaimp as csrtablaimp on Csrmaopera.id = csrtablaimp.idmaopera
left join tipoiva as csrtipoiva on Csrtablaimp.tasa = CsrTipoiva.tasa
where Csrmaopera.origen IN ('FAC','FPE') and Csrmaopera.clasecomp IN ('A','B','C','U') 
AND LEFT(CsrMaopera.numcomp,1)='' and CsrTablaImp.tipoconce IN ('IG','OI')
and CsrMaopera.estado = 0 and CsrCabeza.idmaopera = 110000005949
Group By CsrMaopera.id ,CsrTipoiva.SiapCpraVta
union all
SELECT 'B' as grupo, CsrMaopera.id as orden,0 estado
,CsrTablaImp.tipoconce,SPACE(3) as CodTasa 
,CsrTablaImp.tasa
,SUM(ISNULL(Csrtablaimp.importe,CAST(0 as numeric(12,2)))) as Importe
,SUM(ISNULL(Csrtablaimp.baseimp,CAST(0 as numeric(12,2)))) as BaseImp
from Cabefac as CsrCabeza
left join maopera as Csrmaopera on CsrCabeza.idmaopera = Csrmaopera.id
left join tablaimp as csrtablaimp on Csrmaopera.id = csrtablaimp.idmaopera
where Csrmaopera.origen IN ('FAC','FPE') and Csrmaopera.clasecomp IN ('A','B','C','U') 
AND LEFT(CsrMaopera.numcomp,1)='' and not CsrTablaImp.tipoconce IN ('IG','OI')
and CsrMaopera.estado = 0 and CsrCabeza.idmaopera = 110000005949
Group By CsrMaopera.id ,CsrTablaImp.tipoconce,CsrTablaImp.tasa
Order by CsrMaopera.id