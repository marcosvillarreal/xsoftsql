SELECT null as fecha,Csrcuerfac.idarticulo as idarticulo,Csrcuerfac.codigo as codigo,csrproducto.nombre as articulo, csrproducto.unibulto as unibulto ,csrproducto.vtakilos as pesable
,SUM(CAST((CASE WHEN ISNULL(Csrcuervari.cantidad,-1)=-1 THEN Csrcuerfac.cantidad ELSE Csrcuervari.cantidad end) * CsrCabefac.Signo as numeric(15,2))) as unidades
,SUM(CAST(Csrcuerfac.kilos  * CsrCabefac.Signo as numeric(15,2))) as VtaKilos
,SUM(CAST((CASE WHEN ISNULL(Csrcuervari.volumen,-1)=-1 THEN Csrcuerfac.volumen ELSE Csrcuervari.volumen end) * CsrCabefac.Signo as numeric(15,2))) as VtaLitros
,ISNULL(csrcuervari.idvariedad,0) as idvariedad, ISNULL(CsrVariedad.nombre, ' ') as variedad
from maopera as Csrmaopera
left join cuerfac as Csrcuerfac on  Csrmaopera.id = Csrcuerfac.idmaopera 
left join cabefac as csrcabefac on Csrcuerfac.idcabeza = Csrcabefac.id
left join vendedor as Csrvendedor on Csrmaopera.idvendedor = Csrvendedor.id
left join producto as Csrproducto on Csrcuerfac.idarticulo = Csrproducto.id 
left join cuervari as Csrcuervari on Csrcuerfac.id=Csrcuervari.idcuerfac   left join variedad as CsrVariedad on CsrCuervari.idvariedad = Csrvariedad.id
where CsrMaopera.origen IN ('FAC','FPE') and  not (Csrmaopera.clasecomp in ('K','C')) and Csrmaopera.estado<>'1'
and Csrcabefac.fecha >= '20160601' AND Csrcabefac.fecha < '20160623' and Csrmaopera.Idvendedor>-1
and csrcuerfac.idarticulo>0 and Csrcabefac.Idctacte>-1 and Csrcuerfac.Idarticulo>-1 
 and Csrmaopera.numcomp<>'' 
 and ( (left(CSRmaopera.numcomp,1)='B' and (substring(CSRmaopera.numcomp,2,4)>='0003' and substring(CSRmaopera.numcomp,6,8)>='00003735'  and substring(CSRmaopera.numcomp,2,4)<='0003' and substring(CSRmaopera.numcomp,6,8)<='00003735')))
Group by Csrcuerfac.Idarticulo,Csrcuerfac.codigo,csrproducto.nombre,csrproducto.unibulto, csrproducto.vtakilos,Csrcuervari.idvariedad, csrvariedad.nombre
 Order by CASE WHEN ISNUMERIC(Csrcuerfac.codigo) = 1 THEN CONVERT(int, Csrcuerfac.codigo) ELSE Null END asc