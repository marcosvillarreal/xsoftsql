Select 'A' as grupoDato,Csrcuerpo.*,ISNULL(Csrfletecarga.idmaopera,0) as idmaopera,ISNULL(CsrNmaopera.idvendedor,0) as idvendedor
,LEFT(ISNULL(CsrNmaopera.numcomp,' '),1)+' '+SUBSTRING(ISNULL(CsrNmaopera.numcomp,SPACE(6)),2,4)+' '+RIGHT(ISNULL(CsrNmaopera.numcomp,SPACE(8)),8) as numcomp
,ISNULL(CsrNcabefac.ctacte,SPACE(6)) as ctacte,ISNULL(CsrNcabefac.cnombre,SPACE(30)) as cnombre
,ISNULL(CsrNcabefac.total,0) as totalComp
,ISNULL(CsrNcabefac.fecha,GETDATE()) as fechafac,ISNULL(CsrNcabefac.cdireccion,SPACE(30)) as cdireccion
,ISNULL(Csrvendedor.numero,0) as nrovdor,ISNULL(Csrvendedor.nombre,SPACE(30)) as nomvdor
,CAST(0 as int) as idcuerfac,CAST(0 as int) as idarticulo,SPACE(8) as codigo,CAST(0 as numeric(10,2)) as cantidad,0 as univenta,CAST(0 as int) as unibulto
,CAST(0 as int) as cantorig ,00000 as nrorubro,CAST(0 as numeric(12,2)) as total,CAST(0 as numeric(12,3)) as kilos,CAST(0 as numeric(12,3)) as peso
,CsrNcabefac.signo as signo, CAST(0 as int ) as idubicacion, CAST(0 as numeric(1,0)) as pesable,CAST(1 as numeric(1,0)) as estado
,CAST(0 as numeric(1,0)) as idcuervari,CAST(0 as int) as idvariedad
from fleteplanilla as Csrcuerpo
left join fletecarga as Csrfletecarga on Csrcuerpo.id = Csrfletecarga.idfleteplan
left join Nmaopera as CsrNmaopera on Csrfletecarga.idmaopera = CsrNmaopera.id
left join Ncabefac as CsrNcabefac on Csrfletecarga.idmaopera = CsrNcabefac.idmaopera
left join vendedor as Csrvendedor on CsrNmaopera.idvendedor = Csrvendedor.id
where Csrcuerpo.fecha >= '19000101' AND Csrcuerpo.fecha < '99991231' and  CsrCuerpo.estado='0' 
AND CsrCuerpo.idfletero  > 0 and CsrNmaopera.clasecomp<>'K' and CsrNmaopera.estado='0'
and substring(CsrCuerpo.switch,3,1)=1 and CsrCuerpo.numero  = 3332
and left(Csrnmaopera.switch,1)='0' and RIGHT(Csrcuerpo.switch,1)='1'
UNION ALL
Select 'B' as grupoDato,Csrcuerpo.*,ISNULL(Csrfletecarga.idmaopera,0) as idmaopera,ISNULL(CsrNmaopera.idvendedor,0) as idvendedor,SPACE(15) as numcomp,SPACE(6) as ctacte,CsrNcuerfac.nombre as cnombre,0 as totalComp
,GETDATE() as fechafac,SPACE(30) as cdireccion,0 as nrovdor,SPACE(30) as nomvdor
,CsrNcuerfac.id as idcuerfac,CsrNcuerfac.idarticulo as idarticulo,CsrNcuerfac.codigo as codigo,csrNcuerfac.cantidad as cantidad
,CsrNcuerfac.univenta as univenta,CsrNcuerfac.unibulto as unibulto, CsrNcuerfac.cantorig as cantorig
,ISNULL(Csrrubro.numero,0) as nrorubro,0000000.00 as total,CsrNCuerfac.kilos , CsrProducto.peso
,00 as signo, CsrProducto.idubicacio as idubicacion, CsrProducto.vtakilos as pesable,CAST(1 as numeric(1,0)) as estado
,CAST(0 as numeric(1,0)) as idcuervari,CAST(0 as int) as idvariedad
from fleteplanilla as Csrcuerpo
left join fletecarga as Csrfletecarga on Csrcuerpo.id = Csrfletecarga.idfleteplan
left join Nmaopera as CsrNmaopera on Csrfletecarga.idmaopera = CsrNmaopera.id
left join Ncuerfac as CsrNcuerfac ON Csrfletecarga.idmaopera = CsrNcuerfac.idmaopera
left join producto as Csrproducto on CsrNcuerfac.idarticulo = Csrproducto.id
left join rubro as Csrrubro on Csrproducto.idrubro = Csrrubro.id
where Csrcuerpo.fecha >= '19000101' AND Csrcuerpo.fecha < '99991231' and  CsrCuerpo.estado='0' AND CsrCuerpo.idfletero  > 0 and CsrNmaopera.clasecomp<>'K' and CsrNmaopera.estado='0'
and substring(CsrCuerpo.switch,3,1)=1 and CsrNcuerfac.cantorig<>0 and CsrCuerpo.numero  = 3332
 and left(Csrnmaopera.switch,1)='0' and RIGHT(Csrcuerpo.switch,1)='1'
UNION ALL
Select 'C' as grupoDato,Csrcuerpo.*,ISNULL(Csrfletecarga.idmaopera,0) as idmaopera,0 as idvendedor,SPACE(15) as numcomp,SPACE(6) as ctacte
,ISNULL(Csrsubproducto.nombre,' ') as cnombre,0 as totalComp,GETDATE() as fechafac,SPACE(30) as cdireccion,0 as nrovdor,SPACE(30) as nomvdor
,ISNULL(CsrNcuervari.idcuerfac,0) as idcuerfac,ISNULL(CsrNcuervari.idsubarti,0) as idarticulo,SPACE(8) as codigo,ISNULL(CsrNcuervari.cantidad,0) as cantidad
,0 as univenta,0 as unibulto, ISNULL(CsrNcuervari.cantorig,0) as  cantorig 
,00000 as nrorubro,CAST(0 as numeric(12,2)) as total,CAST(0 as numeric(10,2)) as kilos,CAST(0 as numeric(12,3)) as peso
,00 as signo, CAST(0 as int ) as idubicacion, CAST(0 as numeric(1,0)) as pesable,CAST(1 as numeric(1,0)) as estado
,CsrNCuervari.id as  idcuervari,CsrNCuervari.idvariedad
from fleteplanilla as Csrcuerpo
left join fletecarga as Csrfletecarga on Csrcuerpo.id = Csrfletecarga.idfleteplan
left join Nmaopera as CsrNmaopera on Csrfletecarga.idmaopera = CsrNmaopera.id
left join NCuervari as CsrNcuervari on Csrfletecarga.idmaopera = CsrNcuervari.idmaopera
left join subproducto as CsrSubproducto on CsrNcuervari.idsubarti = CsrSubproducto.id
where Csrcuerpo.fecha >= '19000101' AND Csrcuerpo.fecha < '99991231' and  CsrCuerpo.estado='0' AND CsrCuerpo.idfletero  > 0 and CsrNmaopera.clasecomp<>'K' and CsrNmaopera.estado='0'
and substring(CsrCuerpo.switch,3,1)=1  AND CsrNCuervari.idcuerfac <> 0 and CsrCuerpo.numero  = 3332
 and left(Csrnmaopera.switch,1)='0' and RIGHT(Csrcuerpo.switch,1)='1'