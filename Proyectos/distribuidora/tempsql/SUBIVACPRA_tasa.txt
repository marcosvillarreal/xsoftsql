SELECT 'CA' as grupo,CAST(0 as numeric(12,0)) as id,SPACE(13) as numcomp,SPACE(8) as chrfecha,CAST('ALICUOTA' as Char(30)) as cnombre
,STR(ISNULL(Csrtablaimp.tasa,00.00),5,2)+'%'+SPACE(8) as cuit,0 as signo,CAST(0 as numeric(12,2)) as total,ISNULL(Csrtablaimp.tasa,00.00) as tasa
,SPACE(10) as fechaserver
,SUM((Case when Csrtablaimp.tipoconce='PB'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalPB
,SUM((Case when Csrtablaimp.tipoconce='PG'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalPG
,SUM((Case when Csrtablaimp.tipoconce='PI'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalPI
,SUM((Case when Csrtablaimp.tipoconce='PN'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalPN
,SUM((Case when Csrtablaimp.tipoconce='EX'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalEX
,SUM((Case when Csrtablaimp.tipoconce='RB'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalRB
,SUM((Case when Csrtablaimp.tipoconce='RG'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalRG
,SUM((Case when Csrtablaimp.tipoconce='RI'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalRI
,SUM((Case when Csrtablaimp.tipoconce='NG'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalNG
,SUM((Case when Csrtablaimp.tipoconce='IG'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalIG
,SUM((Case when Csrtablaimp.tipoconce='OI'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalOI
,SUM((Case when Csrtablaimp.tipoconce='II'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalII
,SUM((Case when Csrtablaimp.tipoconce='IN'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalIN
,SUM((Case when Csrtablaimp.tipoconce='IP'
	then ISNULL(Csrtablaimp.importe * ISNULL(CsrCabeza.signo,1)*(-1),CAST( 0 AS NUMERIC(11,2))) else CAST( 0 AS NUMERIC(11,2)) end)) as TotalIP
,CsrCategoiva.abrevia as nomcatego,isnull(CsrPRovincia.nombre,space(30)) as nomcompro
,isnull(CsrTablaimp.idprovincia,0) as idprovincia
from Cabecpra as CsrCabeza
left join maopera as Csrmaopera on CsrCabeza.idmaopera = Csrmaopera.id
left join categoiva as Csrcategoiva on CsrCabeza.idtipoiva = Csrcategoiva.id
left join comprobante as Csrcomprobante on Csrmaopera.idcomproba = Csrcomprobante.id
left join tablaimp as csrtablaimp on Csrmaopera.id = csrtablaimp.idmaopera
left join provincia as CsrProvincia on CsrTablaimp.idprovincia = CsrProvincia.id


where CsrCabeza.pefiscal >= 201606 and CsrCabeza.pefiscal < 201607 and Csrmaopera.origen IN ('CPR') and Csrmaopera.clasecomp IN ('A','B','C','U') 
AND LEFT(CsrMaopera.numcomp,1)<>' '
 and CsrComprobante.libroiva=1 and CsrCabeza.idctacte  > 0 and CsrMaopera.estado='0'
and CsrMaopera.idcomproba  > 0
GROUP BY CsrCategoiva.abrevia,Csrtablaimp.tasa,CsrPRovincia.nombre,CsrTablaimp.idprovincia