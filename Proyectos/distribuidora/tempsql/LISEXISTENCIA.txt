SELECT csrproducto.numero as numero,csrproducto.nombre as nombre,ISNULL(csrdeposito.numero,0) as deposito,csrproducto.unibulto,ISNULL(csrsubproducto.subnumero,0) as subnumero
,ISNULL(csrvariedad.nombre,SPACE(30)) as nomsubprod,ISNULL(Csrexistenc.existe,0) as existe, ISNULL(CsrExistenc.kilos,0) as exi_kilos
,ISNULL(CsrProducto.idubicacio,CAST(0 as int)) as idubicacion, ISNULL(CsrUbicacion.nombre,SPACE(20)) as nomUbicacion
,ISNULL(CsrProducto.idrubro,CAST(0 as int)) as idrubro, ISNULL(CsrRubro.nombre,SPACE(20)) as nomRubro,ISNULL(CsrRubro.numero,0) as NumRubro
,(select ISNULL(SUM(csrMovstock.cantidad*CsrMovstock.signo),0) from movstock as csrmovstock
where csrproducto.id=csrmovstock.idarticulo and csrsubproducto.id=csrmovstock.idsubarti and csrdeposito.id=csrmovstock.iddeposito and Csrmovstock.fecha > '20160624') sumacantidad
,(select ISNULL(SUM(csrMovstock.kilos*CsrMovstock.signo),0) from movstock as csrmovstock
where csrproducto.id=csrmovstock.idarticulo and csrsubproducto.id=csrmovstock.idsubarti and csrdeposito.id=csrmovstock.iddeposito and Csrmovstock.fecha > '20160624') sumakilos
,csrproducto.vtakilos as pesable
FROM producto as csrproducto
left join movstock as csrmovstock on Csrproducto.id = Csrmovstock.idarticulo 
left join deposito as csrdeposito on csrmovstock.iddeposito=csrdeposito.id
left join existenc as Csrexistenc on Csrproducto.id = Csrexistenc.idarticulo and csrdeposito.id=csrexistenc.iddeposito and csrmovstock.idsubarti = Csrexistenc.idsubarti
left join subproducto as Csrsubproducto ON Csrmovstock.idarticulo=csrsubproducto.idarticulo and csrmovstock.idsubarti = CsrSubproducto.id
left join variedad as Csrvariedad on Csrsubproducto.idvariedad = Csrvariedad.id
left join ubicacion as CsrUbicacion on CsrProducto.idubicacio = CsrUbicacion.id
left join rubro as CsrRubro on CsrProducto.idrubro = CsrRubro.id
WHERE Csrproducto.id IN (1100000459,1100000455,1100000456,1100000555,1100000454,1100000458,1100000457,1100000460,1100000450,1100000464,1100000461,1100000447,1100000448,1100000449,1100000465,1100000451,1100000787,1100000788,1100000462,1100000463,1100000446,1100000453,1100000452) and CsrMovStock.iddeposito > 0 
GROUP BY csrproducto.numero,csrproducto.nombre,csrsubproducto.subnumero,csrvariedad.nombre,Csrexistenc.existe,csrproducto.id,csrsubproducto.id,csrproducto.unibulto,csrdeposito.numero
,csrdeposito.id,Csrexistenc.kilos,CsrProducto.idubicacio,CsrUbicacion.nombre,CsrProducto.idrubro,CsrRubro.nombre,CsrRubro.numero,csrproducto.vtakilos
ORDER BY nomUbicacion,numRubro,numero,nomSubprod,deposito,csrproducto.vtakilos