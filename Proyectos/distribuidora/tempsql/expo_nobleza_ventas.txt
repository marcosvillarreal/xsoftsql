SELECT  CsrCtacte.cnumero as codcliente
,Convert(char(8),CsrCabefac.fecha,112) as fecha
,CsrCuerfac.codigo
,sum(CsrCuerfac.cantidad * CsrCabefac.signo) as cantidad
,sum(CAST(ROUND(CsrCuerfac.totalsiva,2) as numeric(18,2)) * CsrCabefac.signo) as total
From Maopera as CsrMaopera
left join Cabefac as CsrCabefac on CsrMaopera.id = CsrCabefac.idmaopera
left join Cuerfac as CsrCuerfac on CsrCabefac.idmaopera = CsrCuerfac.idmaopera and CsrCabefac.id = CsrCuerfac.idcabeza
left join Ctacte as CsrCtacte on CsrCabefac.idctacte = CsrCtacte.id
left join Producto as CsrProducto on CsrCuerfac.idarticulo = CsrProducto.id
left join Rubro as CsrRubro on CsrProducto.idrubro = CsrRubro.id
Where CsrRubro.id = 1100000105
and (CsrCabefac.fecha between '20160626' and '20160711')
Group By CsrCtacte.cnumero,CsrCabefac.fecha,CsrCuerfac.codigo